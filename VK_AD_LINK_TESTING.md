# üîó –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ VK –†–µ–∫–ª–∞–º–Ω–æ–π –°—Å—ã–ª–∫–∏

**–í–∞—à–∞ —Å—Å—ã–ª–∫–∞ –¥–ª—è VK —Ä–µ–∫–ª–∞–º—ã:**
```
https://vk.com/app53875526#utm_source=vk_mini_app&ref={ref}&ref_source={banner_id}&utm_term={user_id}
```

---

## ‚úÖ –ê–ù–ê–õ–ò–ó –°–°–´–õ–ö–ò

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è! üéâ

–í–∞—à–∞ —Å—Å—ã–ª–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **hash (#)** –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - —ç—Ç–æ **–ü–†–ê–í–ò–õ–¨–ù–û** –¥–ª—è VK Mini Apps!

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç VK | –ß—Ç–æ –ø–æ–ª—É—á–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
|----------|-----|---------------|------------------------|
| `utm_source=vk_mini_app` | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π | –ù–µ –º–µ–Ω—è–µ—Ç | `vk_mini_app` |
| `ref={ref}` | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π | –ó–∞–º–µ–Ω–∏—Ç –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ | –ù–∞–ø—Ä–∏–º–µ—Ä: `spring_promo_2025` |
| `ref_source={banner_id}` | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π | –ó–∞–º–µ–Ω–∏—Ç –Ω–∞ ID –±–∞–Ω–Ω–µ—Ä–∞ | –ù–∞–ø—Ä–∏–º–µ—Ä: `banner_12345` |
| `utm_term={user_id}` | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π | –ó–∞–º–µ–Ω–∏—Ç –Ω–∞ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ù–∞–ø—Ä–∏–º–µ—Ä: `123456789` |

---

## üîç –ö–ê–ö –û–ë–†–ê–ë–ê–¢–´–í–ê–ï–¢–°–Ø –í –í–ê–®–ï–ú –ö–û–î–ï

### 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (useUTMTracker.js)

–í–∞—à –∫–æ–¥ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ hash:

```javascript
// useUTMTracker.js - —Å—Ç—Ä–æ–∫–∏ 59-64
let hashString = window.location.hash.substring(1); // —É–±–∏—Ä–∞–µ–º #
if (hashString.startsWith('/')) {
  hashString = hashString.substring(1);
}
const hashParams = new URLSearchParams(hashString);
```

**–ß—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è:**
```javascript
{
  utm_source: "vk_mini_app",
  ref: "spring_promo_2025",        // –∏–∑ {ref}
  ref_source: "banner_12345",      // –∏–∑ {banner_id}
  utm_term: "123456789"            // –∏–∑ {user_id}
}
```

### 2. –ü–µ—Ä–µ–¥–∞—á–∞ –≤ Leads.Tech (useArbitrageTracker.js)

```javascript
// useArbitrageTracker.js - —Å—Ç—Ä–æ–∫–∏ 56-58
s4: utmParams.cid || utmParams.utm_campaign || vkRef || '',  // ref
s5: utmParams.aid || utmParams.utm_content || vkRefSource || '',  // ref_source
s6: userData.id,  // user_id
```

**–ù–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞!** üî¥

–ü–∞—Ä–∞–º–µ—Ç—Ä `ref` –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `s4`, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–¥ –∏—â–µ—Ç:
- `utmParams.cid`
- `utmParams.utm_campaign`
- `vkRef` (–∫–æ—Ç–æ—Ä—ã–π –±–µ—Ä—ë—Ç—Å—è –∏–∑ `utmParams.vk_ref`, –∞ –Ω–µ `utmParams.ref`)

**–ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨!**

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï

–û–±–Ω–æ–≤–∏–º `useArbitrageTracker.js` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```javascript
// –ë–´–õ–û:
const vkRef = utmParams.ref || utmParams.vk_ref || '';
const vkRefSource = utmParams.ref_source || utmParams.vk_ref_source || '';

// –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è leads.tech (—Ñ–æ—Ä–º–∞—Ç –æ—Ñ—Ñ–µ—Ä–æ–≤)
s4: utmParams.cid || utmParams.utm_campaign || vkRef || '',
s5: utmParams.aid || utmParams.utm_content || vkRefSource || '',
s6: userData.id,

// –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
s4: utmParams.ref || utmParams.vk_ref || utmParams.utm_campaign || '',
s5: utmParams.ref_source || utmParams.vk_ref_source || utmParams.utm_content || '',
s6: userData.id || utmParams.utm_term || utmParams.user_id || '',
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –°–ø–æ—Å–æ–± 1: HTML —Ç–µ—Å—Ç–µ—Ä (—Å–æ–∑–¥–∞–Ω –¥–ª—è –≤–∞—Å)

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:
```
/root/vk_react_app/TEST_VK_LINK.html
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Leads.Tech
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –°–ø–æ—Å–æ–± 2: –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É:**
```
https://vk.com/app53875526#utm_source=vk_mini_app&ref=test_campaign&ref_source=banner_001&utm_term=555555
```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ VK –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–µ**

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** (F12):
```javascript
// –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
‚úÖ –ò–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ UTM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: {
  utm_source: "vk_mini_app",
  ref: "test_campaign",
  ref_source: "banner_001",
  utm_term: "555555"
}
```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Leads.Tech:**
```javascript
// –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
üìä –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ leads.tech: {
  s4: "test_campaign",
  s5: "banner_001", 
  s6: "555555"
}
```

### –°–ø–æ—Å–æ–± 3: API —Ç–µ—Å—Ç

```bash
curl -X POST https://bodyexp.ru/api/arbitrage/send-to-leads-tech/ \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "555555",
    "ref": "test_campaign",
    "ref_source": "banner_001",
    "utm_term": "555555",
    "utm_source": "vk_mini_app"
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "leads_tech_params": {
    "s4": "test_campaign",
    "s5": "banner_001",
    "s6": "555555"
  },
  "leads_tech_url": "https://...&sub4=test_campaign&sub5=banner_001&sub6=555555"
}
```

---

## ‚ö†Ô∏è –ù–ê–ô–î–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–í `useArbitrageTracker.js` (—Å—Ç—Ä–æ–∫–∏ 56-58) –ø–∞—Ä–∞–º–µ—Ç—Ä `ref` **–ù–ï –ø–æ–ø–∞–¥–∞–µ—Ç** –≤ `s4`:

```javascript
// –¢–ï–ö–£–©–ò–ô –ö–û–î (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
s4: utmParams.cid || utmParams.utm_campaign || vkRef || '',
//  ^^^^^^^^^^^^ –∏—â–µ—Ç cid –ø–µ—Ä–≤—ã–º, –∞ ref —Ç–æ–ª—å–∫–æ –≤ vkRef

// –ù–æ –≤–∞—à–∞ —Å—Å—ã–ª–∫–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø—Ä–æ—Å—Ç–æ ref, –Ω–µ vk_ref!
```

**–†–µ—à–µ–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏!**

---

## üéØ –ß–¢–û –ü–†–ê–í–ò–õ–¨–ù–û

### ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Å—ã–ª–∫–∏:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `#` (hash) - –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è VK
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- ID –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π: `53875526`

### ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `utm_source=vk_mini_app` - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `ref={ref}` - VK –∑–∞–º–µ–Ω–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- `ref_source={banner_id}` - VK –∑–∞–º–µ–Ω–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- `utm_term={user_id}` - VK –∑–∞–º–µ–Ω–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:
- `useUTMTracker.js` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç hash
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ `utmParams`
- –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ backend

---

## üîß –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ VK –º–∞–∫—Ä–æ—Å—ã:

VK –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–∞–∫—Ä–æ—Å—ã:
- `{user_id}` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚úÖ (—É –≤–∞—Å –µ—Å—Ç—å)
- `{campaign_id}` - ID –∫–∞–º–ø–∞–Ω–∏–∏
- `{ad_id}` - ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- `{banner_id}` - ID –±–∞–Ω–Ω–µ—Ä–∞ ‚úÖ (—É –≤–∞—Å –µ—Å—Ç—å)
- `{creative_id}` - ID –∫—Ä–µ–∞—Ç–∏–≤–∞

### 2. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–±–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π):

```
https://vk.com/app53875526#utm_source=vk_mini_app&utm_campaign={ref}&utm_content={banner_id}&utm_term={user_id}
```

–≠—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π!

### 3. –ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ –∏—Å–ø—Ä–∞–≤—å—Ç–µ –∫–æ–¥

–Ø —Å–µ–π—á–∞—Å –∏—Å–ø—Ä–∞–≤–ª—é `useArbitrageTracker.js` —á—Ç–æ–±—ã –æ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª `ref` –∏ `ref_source`.

---

## üìä –¢–ï–°–¢–û–í–´–ï –°–¶–ï–ù–ê–†–ò–ò

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ VK —Ä–µ–∫–ª–∞–º—ã
```
–°—Å—ã–ª–∫–∞ –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏:
https://vk.com/app53875526#utm_source=vk_mini_app&ref={ref}&ref_source={banner_id}&utm_term={user_id}

VK –∑–∞–º–µ–Ω—è–µ—Ç –Ω–∞:
https://vk.com/app53875526#utm_source=vk_mini_app&ref=winter_promo&ref_source=banner_555&utm_term=123456789

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç:
utm_source: "vk_mini_app"
ref: "winter_promo"
ref_source: "banner_555"
utm_term: "123456789"

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Leads.Tech:
sub4=winter_promo
sub5=banner_555
sub6=123456789
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ (–±–µ–∑ —Ä–µ–∫–ª–∞–º—ã)
```
–°—Å—ã–ª–∫–∞:
https://vk.com/app53875526

–ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ—Ç:
utm_source: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
ref: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

Leads.Tech –ø–æ–ª—É—á–∏—Ç:
sub4=
sub5=
sub6=123456789 (—Ç–æ–ª—å–∫–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
```

---

## üéØ –í–´–í–û–î–´

### –í–∞—à–∞ —Å—Å—ã–ª–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç! ‚úÖ

–ù–æ –Ω—É–∂–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–¥–µ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `ref`.

**–°–µ–π—á–∞—Å –∏—Å–ø—Ä–∞–≤–ª—é —ç—Ç–æ!**

---

## üìã –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø VK –†–ï–ö–õ–ê–ú–´

- [x] –°—Å—ã–ª–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç hash (#)
- [x] ID –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (53875526)
- [x] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –Ω—É–∂–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- [x] VK –º–∞–∫—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
- [ ] –ö–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `ref` (–∏—Å–ø—Ä–∞–≤–ª—è–µ–º —Å–µ–π—á–∞—Å)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∫–ª–∞–º–µ VK

---

**–î–∞—Ç–∞**: 8 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: –°—Å—ã–ª–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞, –Ω–∞–π–¥–µ–Ω–∞ –Ω–µ–±–æ–ª—å—à–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –∏—Å–ø—Ä–∞–≤–ª—è–µ–º!

