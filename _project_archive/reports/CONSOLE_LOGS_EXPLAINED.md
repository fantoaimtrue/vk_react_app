# üìä –û–ë–™–Ø–°–ù–ï–ù–ò–ï –õ–û–ì–û–í –í –ö–û–ù–°–û–õ–ò

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –õ–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

---

## ‚úÖ –≠–¢–û –ù–ï –û–®–ò–ë–ö–ò - –≠–¢–û –ù–û–†–ú–ê–õ–¨–ù–ê–Ø –†–ê–ë–û–¢–ê

### –õ–æ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–∏–¥–∏—Ç–µ:

```javascript
[0.013] common module enabled
error_monitoring.isolated.5cfaa65a.js:1 [25.83] notifier lpGetKey done
error_monitoring.isolated.5cfaa65a.js:1 [35.491] drop key b07e4d88... 32042
```

### –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

#### 1. `common module enabled`
- ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

#### 2. `notifier lpGetKey done`
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- "lpGetKey" - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è long polling
- –°–≤—è–∑–∞–Ω–æ —Å VK Bridge –∏–ª–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

#### 3. `drop key b07e4d88... 32042`
- ‚úÖ –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π –∫–ª—é—á –ø–æ–¥–ø–∏—Å–∫–∏
- –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ß–∏—Å–ª–æ 32042 - –≤–µ—Ä–æ—è—Ç–Ω–æ, timestamp –∏–ª–∏ ID —Å–µ—Å—Å–∏–∏

### –ò—Å—Ç–æ—á–Ω–∏–∫ –ª–æ–≥–æ–≤:

–§–∞–π–ª `error_monitoring.isolated.5cfaa65a.js` - —ç—Ç–æ:
- –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫ (–≤–æ–∑–º–æ–∂–Ω–æ VK –∏–ª–∏ Sentry)
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å (isolated)
- –•–µ—à `5cfaa65a` - –≤–µ—Ä—Å–∏—è —Ñ–∞–π–ª–∞

**–≠–¢–û –ù–ï –û–®–ò–ë–ö–ò! –≠–¢–û DEBUG –ò–ù–§–û–†–ú–ê–¶–ò–Ø** ‚úÖ

---

## üî¥ –†–ï–ê–õ–¨–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

### –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ –ª–æ–≥–∞—Ö, –∞ –≤ –º–∞–∫—Ä–æ—Å–∞—Ö VK!

–í–∞—à–∞ —Å—Å—ã–ª–∫–∞:
```
utm_campaign = {1031631050}      ‚Üê –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ)
utm_content = {{banner_id}}      ‚Üê –Ω–µ –∑–∞–º–µ–Ω–∏–ª—Å—è VK
utm_term = {{user_id}}           ‚Üê –Ω–µ –∑–∞–º–µ–Ω–∏–ª—Å—è VK
```

### –ü–æ—á–µ–º—É –º–∞–∫—Ä–æ—Å—ã –Ω–µ –∑–∞–º–µ–Ω–∏–ª–∏—Å—å:

#### –ü—Ä–∏—á–∏–Ω–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤ VK –†–µ–∫–ª–∞–º–µ
–í —Ä–µ–∫–ª–∞–º–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤—ã –Ω–∞–ø–∏—Å–∞–ª–∏:
```
{{campaign_id}}  ‚Üê –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞
```

–ù–æ VK –¥–æ–ª–∂–µ–Ω –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:
```
1031631050  ‚Üê —á–∏—Å—Ç–æ–µ —á–∏—Å–ª–æ, –±–µ–∑ —Å–∫–æ–±–æ–∫
```

–ê –ø–æ–ª—É—á–∏–ª–æ—Å—å:
```
{1031631050}  ‚Üê –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏
```

#### –ü—Ä–∏—á–∏–Ω–∞ 2: VK –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –º–∞–∫—Ä–æ—Å—ã –≤–µ–∑–¥–µ

–ú–∞–∫—Ä–æ—Å—ã `{{banner_id}}` –∏ `{{user_id}}` –º–æ–≥—É—Ç **–Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å** –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö —Ä–µ–∫–ª–∞–º—ã VK.

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### 1. –ö–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –æ—á–∏—Å—Ç–∫–∏!

–Ø —Ç–æ–ª—å–∫–æ —á—Ç–æ –¥–æ–±–∞–≤–∏–ª –≤ `useUTMTracker.js`:

```javascript
// –î–µ–∫–æ–¥–∏—Ä—É–µ–º URL encoding (%7B ‚Üí {)
cleanValue = decodeURIComponent(cleanValue);

// –£–¥–∞–ª—è–µ–º –Ω–µ–∑–∞–º–µ–Ω—ë–Ω–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã {{banner_id}}
cleanValue = cleanValue.replace(/\{\{([^}]+)\}\}/g, '');

// –£–¥–∞–ª—è–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ {1031631050} ‚Üí 1031631050
cleanValue = cleanValue.replace(/^\{([^}]+)\}$/, '$1');
```

**–¢–µ–ø–µ—Ä—å:**
- `{1031631050}` ‚Üí `1031631050` ‚úÖ
- `{{banner_id}}` ‚Üí —É–¥–∞–ª–∏—Ç—Å—è (–ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- `{{user_id}}` ‚Üí —É–¥–∞–ª–∏—Ç—Å—è (–ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤ VK –†–µ–∫–ª–∞–º–µ

**–í–ú–ï–°–¢–û:**
```
https://vk.com/app53875526#utm_source=vk_ads&utm_campaign={{campaign_id}}&utm_content={{banner_id}}&utm_term={{user_id}}
```

**–ò–°–ü–û–õ–¨–ó–£–ô–¢–ï:**
```
https://vk.com/app53875526#utm_source=vk_ads&utm_campaign={{campaign_id}}
```

**–ü–æ—á–µ–º—É:**
- ‚úÖ `{{campaign_id}}` - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ
- ‚ùå `{{banner_id}}` - –º–æ–∂–µ—Ç –Ω–µ –∑–∞–º–µ–Ω—è—Ç—å—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
- ‚ùå `{{user_id}}` - –º–æ–∂–µ—Ç –Ω–µ –∑–∞–º–µ–Ω—è—Ç—å—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö

### 3. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ campaign_id

```
https://vk.com/app53875526#utm_source=vk_ads&utm_campaign={{campaign_id}}
```

VK Bridge –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ–¥–∞—Å—Ç:
- `vk_user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—á–µ—Ä–µ–∑ VK Bridge API)
- –í—ã –ø–æ–ª—É—á–∏—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ `VKWebAppGetUserInfo`

---

## üß™ –ü–†–û–í–ï–†–ö–ê –í–ê–®–ï–ô –°–°–´–õ–ö–ò

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º, –∫–∞–∫ –≤–∞—à–∞ —Å—Å—ã–ª–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

<function_calls>
<invoke name="run_terminal_cmd">
<parameter name="command">cd /root/vk_react_app && node -e "
const testUrl = 'https://vk.com/app53875526?ref=feed_ads#utm_source=vk_ads&utm_campaign=%7B1031631050%7D&utm_content=%7B%7Bbanner_id%7D%7D&utm_term=%7B%7Buser_id%7D%7D';

// –°–∏–º—É–ª—è—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
const hash = testUrl.split('#')[1];
const params = new URLSearchParams(hash);

console.log('üìä –û–ë–†–ê–ë–û–¢–ö–ê –í–ê–®–ï–ô –°–°–´–õ–ö–ò:');
console.log('');
console.log('–°—ã—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:');
params.forEach((value, key) => {
  console.log(\`  \${key} = \${value}\`);
});

console.log('');
console.log('–ü–æ—Å–ª–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—á–∏—Å—Ç–∫–∏:');
params.forEach((value, key) => {
  let clean = decodeURIComponent(value);
  clean = clean.replace(/\{\{([^}]+)\}\}/g, '');
  clean = clean.replace(/^\{([^}]+)\}$/, '\$1');
  console.log(\`  \${key} = \${clean || '(–ø—É—Å—Ç–æ)'}\`);
});
"
